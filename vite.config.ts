// ============================================================================
// Этот файл использует модульную структуру конфигурации из папки config/build
// Все настройки разделены на логические модули.
// ============================================================================

import { defineConfig } from 'vite'
import { createViteConfig } from './config/build'

// ============================================================================
// ЭКСПОРТ КОНФИГУРАЦИИ
// ============================================================================
// defineConfig - хелпер от Vite для типизации и автодополнения
// Используем функцию вместо объекта, чтобы получить доступ к mode и command
// mode - режим сборки ('development' | 'production' | 'test')
// command - команда запуска ('serve' | 'build')
// ============================================================================

export default defineConfig(({ mode, command }) => {
	// ==========================================================================
	// СОЗДАНИЕ КОНФИГУРАЦИИ ИЗ МОДУЛЕЙ
	// ==========================================================================
	// Вся логика конфигурации находится в папке config/build:
	// - types.ts              - TypeScript типы
	// - env.config.ts         - загрузка переменных окружения
	// - plugins.config.ts     - конфигурация плагинов
	// - resolve.config.ts     - алиасы путей
	// - server.config.ts      - настройки dev сервера
	// - preview.config.ts     - настройки preview сервера
	// - build.config.ts       - настройки сборки и code splitting
	// - css.config.ts         - настройки CSS и препроцессоров
	// - optimization.config.ts - оптимизация зависимостей
	// - constants.config.ts   - глобальные константы
	// - index.ts              - главный модуль, объединяющий всё
	// ==========================================================================

	return createViteConfig({ mode, command })
})
