// ============================================================================
// КОНФИГУРАЦИЯ ПЕРЕМЕННЫХ ОКРУЖЕНИЯ
// ============================================================================
// Настройки для работы с .env файлами
// ============================================================================

import { loadEnv } from "vite";
import type { EnvVariables } from "./types";

// ============================================================================
// ЗАГРУЗКА ПЕРЕМЕННЫХ ОКРУЖЕНИЯ
// ============================================================================
// loadEnv загружает переменные из .env файлов в зависимости от режима:
// - .env                 - загружается всегда
// - .env.local           - загружается всегда, игнорируется git
// - .env.[mode]          - загружается только в указанном режиме
// - .env.[mode].local    - загружается только в указанном режиме, игнорируется git
//
// Параметры loadEnv:
// 1. mode - текущий режим (development/production)
// 2. process.cwd() - директория для поиска .env файлов
// 3. '' - префикс переменных (пустой = загрузить все переменные)
//
// ВАЖНО: По умолчанию Vite загружает только переменные с префиксом VITE_
// Передавая '' мы загружаем ВСЕ переменные для использования в конфигурации
// ============================================================================

/**
 * Загрузить переменные окружения
 * @param mode - режим сборки ('development' | 'production')
 */
export function loadEnvironment(mode: string): EnvVariables {
  return loadEnv(mode, process.cwd(), "") as EnvVariables;
}

/**
 * Получить префикс для переменных окружения
 * Префикс для переменных, доступных в клиентском коде
 * По умолчанию 'VITE_' - только переменные с этим префиксом
 * будут доступны через import.meta.env
 *
 * БЕЗОПАСНОСТЬ: Никогда не используйте переменные без префикса
 * в клиентском коде - они могут содержать секретные данные!
 */
export function getEnvPrefix(): string {
  return "VITE_";
}
